<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–°–æ–∑–¥–∞–Ω–∏–µ –∫–≤–µ—Å—Ç–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–≤–µ—Å—Ç–∞ -->
        <div class="quest-header">
            <h1 id="questTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–≤–µ—Å—Ç–∞</h1>
            <button class="edit-btn" onclick="editQuestTitle()">‚úèÔ∏è</button>
        </div>

        <!-- –°–ø–∏—Å–æ–∫ —ç—Ç–∞–ø–æ–≤ -->
        <div class="stages-section">
            <h2>–≠—Ç–∞–ø—ã –∫–≤–µ—Å—Ç–∞</h2>
            <div id="stagesList" class="stages-list">
                <!-- –≠—Ç–∞–ø—ã –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
            <button class="add-stage-btn" onclick="showStageTypeSelector()">+ –î–æ–±–∞–≤–∏—Ç—å —ç—Ç–∞–ø</button>
        </div>

        <!-- –§–æ—Ä–º–∞ —Å–æ–∑–¥–∞–Ω–∏—è/—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —ç—Ç–∞–ø–∞ -->
        <div id="stageForm" class="stage-form hidden">
            <div class="form-header">
                <h3 id="formTitle">–ù–æ–≤—ã–π —ç—Ç–∞–ø</h3>
                <button class="back-btn" onclick="hideStageForm()">‚Üê –ù–∞–∑–∞–¥</button>
            </div>

            <!-- –í—ã–±–æ—Ä —Ç–∏–ø–∞ —ç—Ç–∞–ø–∞ -->
            <div id="stageTypeSelector" class="stage-type-selector">
                <h4>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —ç—Ç–∞–ø–∞:</h4>
                <div class="type-buttons">
                    <button onclick="selectStageType('message')">üìù –°–æ–æ–±—â–µ–Ω–∏–µ</button>
                    <button onclick="selectStageType('quiz')">‚ùì –í–∏–∫—Ç–æ—Ä–∏–Ω–∞</button>
                    <button onclick="selectStageType('geo')">üìç –ì–µ–æ —Ç–æ—á–∫–∞</button>
                    <button onclick="selectStageType('question')">üí¨ –û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å</button>
                </div>
            </div>

            <!-- –§–æ—Ä–º—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ —ç—Ç–∞–ø–æ–≤ -->
            <div id="stageForms" class="stage-forms">
                <!-- –§–æ—Ä–º–∞ –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏—è -->
                <div id="messageForm" class="stage-form-content hidden">
                    <label>–°–æ–æ–±—â–µ–Ω–∏–µ:</label>
                    <textarea id="messageText" placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
                    <button class="add-completion-btn" onclick="toggleCompletionMessage('message')">
                        üìÑ –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
                    </button>
                    <div id="messageCompletion" class="completion-message hidden">
                        <label>–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏:</label>
                        <textarea id="messageCompletionText" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞..."></textarea>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ –¥–ª—è –≤–∏–∫—Ç–æ—Ä–∏–Ω—ã -->
                <div id="quizForm" class="stage-form-content hidden">
                    <label>–í–æ–ø—Ä–æ—Å:</label>
                    <input type="text" id="quizQuestion" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å...">
                    
                    <div id="quizAnswers">
                        <div class="answer-row">
                            <input type="text" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 1">
                            <input type="checkbox" class="correct-answer">
                            <label>–í–µ—Ä–Ω—ã–π</label>
                        </div>
                        <div class="answer-row">
                            <input type="text" placeholder="–í–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞ 2">
                            <input type="checkbox" class="correct-answer">
                            <label>–í–µ—Ä–Ω—ã–π</label>
                        </div>
                    </div>
                    
                    <button class="add-answer-btn" onclick="addQuizAnswer()">+ –î–æ–±–∞–≤–∏—Ç—å –≤–∞—Ä–∏–∞–Ω—Ç –æ—Ç–≤–µ—Ç–∞</button>
                    
                    <button class="add-completion-btn" onclick="toggleCompletionMessage('quiz')">
                        üìÑ –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
                    </button>
                    <div id="quizCompletion" class="completion-message hidden">
                        <label>–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏:</label>
                        <textarea id="quizCompletionText" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞..."></textarea>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ –¥–ª—è –≥–µ–æ —Ç–æ—á–∫–∏ -->
                <div id="geoForm" class="stage-form-content hidden">
                    <label>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–æ—á–∫—É –Ω–∞ –∫–∞—Ä—Ç–µ:</label>
                    <div id="map" class="map-container"></div>
                    <div class="coordinates">
                        <span>–®–∏—Ä–æ—Ç–∞: <span id="latitude">-</span></span>
                        <span>–î–æ–ª–≥–æ—Ç–∞: <span id="longitude">-</span></span>
                    </div>
                    
                    <button class="add-completion-btn" onclick="toggleCompletionMessage('geo')">
                        üìÑ –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
                    </button>
                    <div id="geoCompletion" class="completion-message hidden">
                        <label>–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏:</label>
                        <textarea id="geoCompletionText" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞..."></textarea>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ –¥–ª—è –≤–æ–ø—Ä–æ—Å–∞ -->
                <div id="questionForm" class="stage-form-content hidden">
                    <label>–í–æ–ø—Ä–æ—Å:</label>
                    <input type="text" id="questionText" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å...">
                    
                    <label>–ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã:</label>
                    <div id="correctAnswers">
                        <input type="text" placeholder="–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç 1">
                    </div>
                    <button class="add-answer-btn" onclick="addCorrectAnswer()">+ –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç</button>
                    
                    <button class="add-completion-btn" onclick="toggleCompletionMessage('question')">
                        üìÑ –°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
                    </button>
                    <div id="questionCompletion" class="completion-message hidden">
                        <label>–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏:</label>
                        <textarea id="questionCompletionText" placeholder="–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —ç—Ç–∞–ø–∞..."></textarea>
                    </div>
                </div>
            </div>

            <!-- –û–±—â–∏–µ –ø–æ–ª—è –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ -->
            <div class="stage-name">
                <label>–ù–∞–∑–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–∞:</label>
                <input type="text" id="stageName" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–∞...">
            </div>

            <button id="submitStageBtn" class="submit-btn" onclick="submitStage()" disabled>–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ö–∞—Ä—Ç–∞ (–ø–æ–¥–∫–ª—é—á–∞–µ–º Leaflet) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script src="script.js"></script>
</body>
</html>
